!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.zma=t()}(this,function(){"use strict";var e=function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)};function t(e){return"string"==typeof e}function n(e){return"function"==typeof e}function r(e){return"[object Array]"==Object.prototype.toString.call(e)}function i(e){this.extendSolt=e,this.msgs=[]}return i.prototype.on=function(e,t){this.extendSolt.on(e,t)&&this.msgs.push([e,t])},i.prototype.fire=function(e){this.extendSolt.fire(e)},i.prototype.once=function(e,t){this.extendSolt.once(e,t)&&this.onceEvents.push([e,t])},i.prototype.unbind=function(e){this.extendSolt.unbind(e)},i.prototype.freezeEvent=function(e){this.extendSolt.freezeEvent(e)},i.prototype.clearFreezeEvent=function(e){this.extendSolt.clearFreezeEvent(e)},i.prototype.dispose=function(){for(var e=this.msgs,t=e.length;t--;)this.extendSolt.unbind(e[t][0],e[t][1]);this.msgs=null,this.extendSolt=null},i.prototype.clear=function(){this.msgs=null,this.extendSolt=null,this.extendSolt.clear()},{events:{},freezeEvents:[],onceEvents:[],on:function(e,i){if((t(e)||r(e))&&n(i)){if(!r(e)){var o=this.events[e];o||(o=this.events[e]=[]);for(var s=o.length;s--;)if(o[s]==i)return!1;return o.push(i),!0}var f=!0,l=!1,u=void 0;try{for(var h,a=e[Symbol.iterator]();!(f=(h=a.next()).done);f=!0){var v=h.value;this.on(v,i)}}catch(e){l=!0,u=e}finally{try{!f&&a.return&&a.return()}finally{if(l)throw u}}}return!1},fire:function(n){if(t(n)||r(n)){for(var i=arguments.length,o=Array(i>1?i-1:0),s=1;s<i;s++)o[s-1]=arguments[s];if(r(n)){var f=!0,l=!1,u=void 0;try{for(var h,a=n[Symbol.iterator]();!(f=(h=a.next()).done);f=!0){var v=h.value;this.fire.apply(this,[v].concat(e(o)))}}catch(e){l=!0,u=e}finally{try{!f&&a.return&&a.return()}finally{if(l)throw u}}}else{var c=this.events[n];if(!c||this.freezeEvents.indexOf(n)>=0)return!1;for(var y=0;y<c.length;)c[y].apply(c,e(o)),y++;for(var p=0;p<this.onceEvents.length;p++){var d=this.onceEvents,x=d[p],E=this.events[n];if(x[0]===n)for(var g=0;g<E.length;g++)if(x[1]===E[g]){E.splice(g,1),d.splice(p,1);break}}this.events[n].length||delete this.events[n]}}},unbind:function(e,r){if(t(e)||n(r))if(r){var i=this.events[e],o=i.length;if(i&&o){for(;o--;)if(i[o]==r){i.splice(o,1);break}o||delete this.events[e]}}else delete this.events[e]},once:function(e,r){t(e)&&n(r)&&(this.onceEvents.push([e,r]),this.on(e,r))},freezeEvent:function(e){if(t(e)||r(e))if(r(e)){var n=!0,i=!1,o=void 0;try{for(var s,f=e[Symbol.iterator]();!(n=(s=f.next()).done);n=!0){var l=s.value;this.freezeEvent(l)}}catch(e){i=!0,o=e}finally{try{!n&&f.return&&f.return()}finally{if(i)throw o}}}else this.freezeEvents.push(e)},clearFreezeEvent:function(e){if(t(e)||r(e))if(r(e)){var n=!0,i=!1,o=void 0;try{for(var s,f=e[Symbol.iterator]();!(n=(s=f.next()).done);n=!0){var l=s.value;this.clearFreezeEvent(l)}}catch(e){i=!0,o=e}finally{try{!n&&f.return&&f.return()}finally{if(i)throw o}}}else{var u=this.freezeEvents.indexOf(e);u>=0&&this.freezeEvents.splice(u,1)}},clear:function(){this.events=null,this.freezeEvents=null,this.onceEvents=null},getProxy:function(e){return new i(this)}}});
