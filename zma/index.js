!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.zma=e()}(this,function(){"use strict";var t=function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)};function e(t){return"string"==typeof t}function n(t){return"function"==typeof t}function r(t){return"[object Array]"==Object.prototype.toString.call(t)}function o(t){this.extendSolt=t,this.msgs=[]}return o.prototype.on=function(t,e){this.extendSolt.on(t,e)},o.prototype.fire=function(t){this.extendSolt.fire(t)},o.prototype.once=function(t,e){this.extendSolt.once(t,e)&&this.onceEvents.push([t,e])},o.prototype.unbind=function(t){this.extendSolt.unbind(t)},o.prototype.dispose=function(){for(var t=this.msgs,e=t.length;e--;)this.extendSolt.bind(t[e][0],t[e][1]);this.msgs=null,this.extendSolt=null},{events:{},freezeEvents:[],onceEvents:[],on:function(t,r){if(e(t)&&n(r)){var i=this.events[t];i||(i=this.events[t]=[]);for(var o=i.length;o--;)if(i[o]==r)return!1;return i.push(r),!0}return!1},fire:function(n){if(e(n)||r(n)){for(var i=arguments.length,o=Array(i>1?i-1:0),s=1;s<i;s++)o[s-1]=arguments[s];if(r(n)){var f=!0,u=!1,h=void 0;try{for(var c,l=n[Symbol.iterator]();!(f=(c=l.next()).done);f=!0){var a=c.value;this.fire.apply(this,[a].concat(t(o)))}}catch(t){u=!0,h=t}finally{try{!f&&l.return&&l.return()}finally{if(u)throw h}}}else{var v=this.events[n];if(!v||this.freezeEvents.indexOf(n)>=0)return!1;for(var p=0;p<v.length;)v[p].apply(v,t(o)),p++;for(var y=0;y<this.onceEvents.length;y++){var d=this.onceEvents,g=d[y],x=this.events[n];if(g[0]===n)for(var b=0;b<x.length;b++)if(g[1]===x[b]){x.splice(b,1),d.splice(y,1);break}}}}},unbind:function(t,r){if(e(t)||n(r))if(r){var o=this.events[t],s=o.length;if(o&&s)for(;s--;)if(o[i]==r){o.splice(i,1);break}}else delete this.events[t]},once:function(t,r){e(t)&&n(r)&&(this.onceEvents.push([t,r]),this.on(t,r))},getProxy:function(t){return new o(this)}}});
